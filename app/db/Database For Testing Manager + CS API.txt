---> Chỉ update data để chạy thử API không update table nào hết

-- phpMyAdmin SQL Dump
-- version 5.2.1
-- https://www.phpmyadmin.net/
--
-- Máy chủ: 127.0.0.1
-- Thời gian đã tạo: Th10 20, 2025 lúc 06:49 PM
-- Phiên bản máy phục vụ: 10.4.32-MariaDB
-- Phiên bản PHP: 8.2.12

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Cơ sở dữ liệu: `lms_db`
--

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `attendance`
--

CREATE TABLE `attendance` (
  `attendance_id` int(11) NOT NULL,
  `assignment_id` int(11) NOT NULL,
  `date` date NOT NULL,
  `status` enum('present','absent','late') NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Đang đổ dữ liệu cho bảng `attendance`
--

INSERT INTO `attendance` (`attendance_id`, `assignment_id`, `date`, `status`) VALUES
(1, 1, '2025-10-10', 'present'),
(2, 1, '2025-10-12', 'late'),
(3, 2, '2025-10-11', 'present'),
(4, 2, '2025-10-14', 'absent'),
(5, 3, '2025-10-11', 'present'),
(6, 3, '2025-10-14', 'present'),
(7, 4, '2025-10-13', 'present'),
(8, 4, '2025-10-15', 'late'),
(9, 4, '2025-10-19', 'present');

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `classes`
--

CREATE TABLE `classes` (
  `class_id` int(11) NOT NULL,
  `class_name` varchar(100) NOT NULL,
  `lecturer_id` int(11) DEFAULT NULL,
  `schedule` datetime(6) NOT NULL,
  `place` varchar(255) DEFAULT NULL,
  `created_by` int(11) NOT NULL,
  `status` enum('active','archived','pending') NOT NULL,
  `created_at` datetime NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Đang đổ dữ liệu cho bảng `classes`
--

INSERT INTO `classes` (`class_id`, `class_name`, `lecturer_id`, `schedule`, `place`, `created_by`, `status`, `created_at`) VALUES
(1, 'Python Cơ Bản', 2, '2025-10-14 23:36:03.000000', NULL, 1, 'active', '2025-10-19 18:53:07'),
(2, 'Java Nâng Cao', 2, '2025-10-13 08:36:18.000000', NULL, 1, 'active', '2025-10-19 18:53:07'),
(3, 'Phân Tích Hệ Thống', 1, '2025-10-08 14:16:32.000000', NULL, 1, 'active', '2025-10-19 18:53:07'),
(6, 'abc', NULL, '2025-10-19 20:45:00.000000', NULL, 8, 'active', '2025-10-19 17:16:37'),
(7, 'abc', NULL, '2025-10-19 20:45:00.000000', NULL, 8, 'active', '2025-10-19 17:17:01'),
(8, 'abc', NULL, '2025-10-19 20:45:00.000000', 'b', 7, 'active', '2025-10-19 17:17:08'),
(9, 'abc', NULL, '2025-10-19 20:45:00.000000', 'a', 8, 'active', '2025-10-19 17:17:46');

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `class_assignments`
--

CREATE TABLE `class_assignments` (
  `assignment_id` int(11) NOT NULL,
  `class_id` int(11) NOT NULL,
  `student_id` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Đang đổ dữ liệu cho bảng `class_assignments`
--

INSERT INTO `class_assignments` (`assignment_id`, `class_id`, `student_id`) VALUES
(1, 1, 1),
(2, 2, 1),
(3, 2, 2),
(4, 3, 2);

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `grades`
--

CREATE TABLE `grades` (
  `grade_id` int(11) NOT NULL,
  `assignment_id` int(11) NOT NULL,
  `grade` float NOT NULL,
  `grade_type` enum('process','project') NOT NULL,
  `remarks` text DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Đang đổ dữ liệu cho bảng `grades`
--

INSERT INTO `grades` (`grade_id`, `assignment_id`, `grade`, `grade_type`, `remarks`) VALUES
(1, 1, 5, 'process', 'good'),
(2, 1, 9.2, 'project', 'Xây dựng project nhỏ hoàn chỉnh.'),
(3, 2, 8.5, 'process', 'Hiểu Java khá tốt, cần luyện thêm phần OOP.'),
(4, 2, 8.8, 'project', 'Bài đồ án hoàn chỉnh, trình bày chuyên nghiệp.'),
(5, 3, 7.8, 'process', 'Chưa nắm chắc phần phân tích yêu cầu.'),
(6, 3, 8.3, 'project', 'Đồ án khá tốt, nhưng thiếu một vài tính năng.'),
(7, 4, 9.5, 'process', 'Tham gia đầy đủ, hiểu sâu kiến thức.'),
(8, 4, 9.8, 'project', 'Bài kiểm tra xuất sắc, trình bày rõ ràng.');

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `lecturers`
--

CREATE TABLE `lecturers` (
  `lecturer_id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `department` varchar(100) DEFAULT NULL,
  `total_hours` int(11) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Đang đổ dữ liệu cho bảng `lecturers`
--

INSERT INTO `lecturers` (`lecturer_id`, `user_id`, `department`, `total_hours`) VALUES
(1, 7, 'Công nghệ thông tin', 120),
(2, 8, 'Khoa học máy tính', 95);

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `notifications`
--

CREATE TABLE `notifications` (
  `notification_id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `title` text NOT NULL,
  `message` text NOT NULL,
  `is_read` tinyint(1) NOT NULL,
  `created_at` datetime NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Đang đổ dữ liệu cho bảng `notifications`
--

INSERT INTO `notifications` (`notification_id`, `user_id`, `title`, `message`, `is_read`, `created_at`) VALUES
(1, 1, 'Báo cáo tuần mới', 'Báo cáo tổng hợp hiệu suất giảng viên tuần này đã được tạo.', 0, '2025-10-19 18:53:06'),
(2, 1, 'Hệ thống cập nhật', 'Phiên bản mới của hệ thống LMS đã được triển khai thành công.', 1, '2025-10-17 18:53:06'),
(3, 1, 'Yêu cầu duyệt lớp học', 'Có 3 lớp học mới đang chờ bạn duyệt trong phần quản lý lớp.', 0, '2025-10-19 18:53:06'),
(4, 1, 'Thông báo bảo trì', 'Hệ thống sẽ được bảo trì vào tối thứ Bảy, 22h - 23h.', 1, '2025-10-16 18:53:06');

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `reports`
--

CREATE TABLE `reports` (
  `report_id` int(11) NOT NULL,
  `generated_by` int(11) NOT NULL,
  `report_type` varchar(100) NOT NULL,
  `file_url` varchar(255) NOT NULL,
  `created_at` datetime NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `roles`
--

CREATE TABLE `roles` (
  `role_id` int(11) NOT NULL,
  `role_name` varchar(50) NOT NULL,
  `description` varchar(255) DEFAULT NULL,
  `created_at` datetime NOT NULL,
  `updated_at` datetime DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Đang đổ dữ liệu cho bảng `roles`
--

INSERT INTO `roles` (`role_id`, `role_name`, `description`, `created_at`, `updated_at`) VALUES
(1, 'manager', 'System Manager - quản trị toàn hệ thống', '2025-10-19 18:53:06', NULL),
(2, 'tc', 'Training Coordinator - điều phối đào tạo', '2025-10-19 18:53:06', NULL),
(3, 'cs', 'Customer Support - chăm sóc học viên', '2025-10-19 18:53:06', NULL),
(4, 'lec', 'Lecturer - giảng viên', '2025-10-19 18:53:06', NULL),
(5, 'student', 'Student - học viên', '2025-10-19 18:53:06', NULL);

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `students`
--

CREATE TABLE `students` (
  `student_id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `enrollment_date` date NOT NULL,
  `status` enum('active','inactive') NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Đang đổ dữ liệu cho bảng `students`
--

INSERT INTO `students` (`student_id`, `user_id`, `enrollment_date`, `status`) VALUES
(1, 9, '2025-10-18', 'active'),
(2, 10, '2025-10-18', 'active'),
(3, 13, '2025-10-20', 'inactive'),
(4, 14, '2025-10-20', 'active'),
(5, 15, '2025-10-20', 'active');

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `tickets`
--

CREATE TABLE `tickets` (
  `ticket_id` int(11) NOT NULL,
  `submitted_by` int(11) NOT NULL,
  `assigned_to` int(11) DEFAULT NULL,
  `issue_type` varchar(100) NOT NULL,
  `title` varchar(150) NOT NULL,
  `description` text NOT NULL,
  `status` enum('open','in_progress','resolved') NOT NULL,
  `created_at` datetime NOT NULL,
  `resolved_at` datetime DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Đang đổ dữ liệu cho bảng `tickets`
--

INSERT INTO `tickets` (`ticket_id`, `submitted_by`, `assigned_to`, `issue_type`, `title`, `description`, `status`, `created_at`, `resolved_at`) VALUES
(1, 3, 1, 'System Bug', 'Lỗi phân công lớp học', 'Không thể phân công giảng viên cho lớp LEC102.', 'open', '2025-10-19 18:53:06', NULL),
(2, 4, 1, 'Class Request', 'Yêu cầu thêm lớp học mới', 'Cần thêm lớp Python Nâng Cao vào học kỳ này.', 'in_progress', '2025-10-18 18:53:06', NULL),
(3, 5, 1, 'System Bug', 'Sinh viên không truy cập được LMS', 'Một số sinh viên báo lỗi 500 khi đăng nhập LMS.', 'open', '2025-10-19 18:53:06', NULL),
(4, 6, 1, 'Account Issue', 'Yêu cầu hỗ trợ tài khoản', 'Sinh viên CS102 quên mật khẩu cần reset.', 'resolved', '2025-10-17 18:53:06', NULL),
(5, 7, 1, 'System Bug', 'Không xem được danh sách sinh viên', 'Danh sách sinh viên không tải được trong LMS.', 'open', '2025-10-19 18:53:06', NULL),
(6, 8, 1, 'Request', 'Yêu cầu cấp tài khoản Zoom', 'Cần tài khoản Zoom để giảng dạy trực tuyến.', 'resolved', '2025-10-16 18:53:06', NULL),
(7, 10, 1, 'Notification Issue', 'Không nhận được email thông báo', 'Không có email khi giảng viên đăng bài mới.', 'open', '2025-10-16 18:53:06', NULL),
(8, 9, 1, 'Payment Error', 'Lỗi thanh toán học phí', 'Em không thanh toán được học phí qua LMS.', 'resolved', '2025-10-14 18:53:06', NULL),
(10, 7, 1, 'Class Request', 'Class Assignment Request for Class ID: 4', 'Lecturer with user_id 7 has requested to be assigned to class \'Web cơ bản\' (ID: 4).', 'open', '2025-10-19 14:56:42', NULL),
(11, 9, 5, 'Student Feedback', 'Thiếu tài liệu tham khảo', 'Không tìm thấy các tài liệu đọc thêm được đề cập trong slide bài giảng môn CSD101.', 'open', '2025-10-20 08:30:00', NULL),
(25, 14, 1, 'Account Request', 'Account approval request for Student04', 'Please review and approve account for Student04 <student04@gmail.com>. Created by Customer Support.', 'resolved', '2025-10-20 15:15:46', '2025-10-20 16:16:10'),
(26, 15, 1, 'Account Request', 'Yêu cầu duyệt tài khoản học sinh Student05', 'Xin vui lòng xem xét và phê duyệt học sinh. Họ tên: Student05, Email: student05@gmail.com.', 'resolved', '2025-10-20 16:35:21', '2025-10-20 16:37:41');

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `users`
--

CREATE TABLE `users` (
  `user_id` int(11) NOT NULL,
  `name` varchar(100) NOT NULL,
  `email` varchar(100) NOT NULL,
  `password_hash` varchar(255) NOT NULL,
  `role_id` int(11) NOT NULL,
  `status` varchar(11) NOT NULL,
  `created_at` datetime NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Đang đổ dữ liệu cho bảng `users`
--

INSERT INTO `users` (`user_id`, `name`, `email`, `password_hash`, `role_id`, `status`, `created_at`) VALUES
(1, 'Manager One', 'manager1@lms.com', '$2b$12$BARBagZbum3Bsok453JM0OJtrccGnZydq1MkkZ.jEUAEIUAf5GPhO', 1, 'deactivated', '2025-10-16 17:58:19'),
(2, 'Manager Two', 'manager2@lms.com', '$2b$12$BARBagZbum3Bsok453JM0OJtrccGnZydq1MkkZ.jEUAEIUAf5GPhO', 1, 'deactivated', '2025-10-16 17:58:19'),
(3, 'TC One', 'tc1@lms.com', '$2b$12$BARBagZbum3Bsok453JM0OJtrccGnZydq1MkkZ.jEUAEIUAf5GPhO', 2, 'active', '2025-10-16 17:58:19'),
(4, 'TC Two', 'tc2@lms.com', '$2b$12$BARBagZbum3Bsok453JM0OJtrccGnZydq1MkkZ.jEUAEIUAf5GPhO', 2, 'active', '2025-10-16 17:58:19'),
(5, 'CS One', 'cs1@lms.com', '$2b$12$BARBagZbum3Bsok453JM0OJtrccGnZydq1MkkZ.jEUAEIUAf5GPhO', 3, 'active', '2025-10-16 17:58:19'),
(6, 'CS Two', 'cs2@lms.com', '$2b$12$BARBagZbum3Bsok453JM0OJtrccGnZydq1MkkZ.jEUAEIUAf5GPhO', 3, 'active', '2025-10-16 17:58:19'),
(7, 'Lecturer One', 'lec1@lms.com', '$2b$12$BARBagZbum3Bsok453JM0OJtrccGnZydq1MkkZ.jEUAEIUAf5GPhO', 4, 'active', '2025-10-16 17:58:19'),
(8, 'Lecturer Two', 'lec2@lms.com', '$2b$12$BARBagZbum3Bsok453JM0OJtrccGnZydq1MkkZ.jEUAEIUAf5GPhO', 4, 'active', '2025-10-16 17:58:19'),
(9, 'Student One', 'student1@lms.com', '$2b$12$uOQbMFjZhq7gqZi2j6vtL.dZu/M11Z4rivqEWExbD.HNkTg2sfkwO', 5, 'active', '2025-10-18 16:07:30'),
(10, 'Student Two', 'student2@lms.com', '$2b$12$uOQbMFjZhq7gqZi2j6vtL.dZu/M11Z4rivqEWExbD.HNkTg2sfkwO', 5, 'deactivated', '2025-10-18 16:07:30'),
(11, 'Student03', 'student03@gmail.com', '$2b$12$re6XjddOfysoGuebu1dizOFkDwXh/IoKmlv3yUNQ0kD68atWJhSlG', 5, 'deactivated', '2025-10-20 15:05:54'),
(14, 'Student04', 'student04@gmail.com', '$2b$12$uGTxCmiNZn53r.In.fNoMOCoxQCjT./nBdlxM22MnSVw9hzhWEflG', 5, 'active', '2025-10-20 15:16:29'),
(15, 'Student05', 'student05@gmail.com', '$2b$12$mZfAQLKQeXqPbRqDswmOc./ecNjZypY20blIr/PUJmk0YuFI8NInO', 5, 'active', '2025-10-20 16:35:59');

--
-- Chỉ mục cho các bảng đã đổ
--

--
-- Chỉ mục cho bảng `attendance`
--
ALTER TABLE `attendance`
  ADD PRIMARY KEY (`attendance_id`),
  ADD KEY `assignment_id` (`assignment_id`);

--
-- Chỉ mục cho bảng `classes`
--
ALTER TABLE `classes`
  ADD PRIMARY KEY (`class_id`),
  ADD KEY `lecturer_id` (`lecturer_id`),
  ADD KEY `created_by` (`created_by`);

--
-- Chỉ mục cho bảng `class_assignments`
--
ALTER TABLE `class_assignments`
  ADD PRIMARY KEY (`assignment_id`),
  ADD UNIQUE KEY `uq_class_student` (`class_id`,`student_id`),
  ADD KEY `student_id` (`student_id`);

--
-- Chỉ mục cho bảng `grades`
--
ALTER TABLE `grades`
  ADD PRIMARY KEY (`grade_id`),
  ADD KEY `assignment_id` (`assignment_id`);

--
-- Chỉ mục cho bảng `lecturers`
--
ALTER TABLE `lecturers`
  ADD PRIMARY KEY (`lecturer_id`),
  ADD UNIQUE KEY `user_id` (`user_id`);

--
-- Chỉ mục cho bảng `notifications`
--
ALTER TABLE `notifications`
  ADD PRIMARY KEY (`notification_id`),
  ADD KEY `user_id` (`user_id`);

--
-- Chỉ mục cho bảng `reports`
--
ALTER TABLE `reports`
  ADD PRIMARY KEY (`report_id`),
  ADD KEY `generated_by` (`generated_by`);

--
-- Chỉ mục cho bảng `roles`
--
ALTER TABLE `roles`
  ADD PRIMARY KEY (`role_id`),
  ADD UNIQUE KEY `role_name` (`role_name`);

--
-- Chỉ mục cho bảng `students`
--
ALTER TABLE `students`
  ADD PRIMARY KEY (`student_id`);

--
-- Chỉ mục cho bảng `tickets`
--
ALTER TABLE `tickets`
  ADD PRIMARY KEY (`ticket_id`),
  ADD KEY `submitted_by` (`submitted_by`),
  ADD KEY `assigned_to` (`assigned_to`);

--
-- Chỉ mục cho bảng `users`
--
ALTER TABLE `users`
  ADD PRIMARY KEY (`user_id`),
  ADD UNIQUE KEY `email` (`email`),
  ADD KEY `role_id` (`role_id`);

--
-- AUTO_INCREMENT cho các bảng đã đổ
--

--
-- AUTO_INCREMENT cho bảng `attendance`
--
ALTER TABLE `attendance`
  MODIFY `attendance_id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=11;

--
-- AUTO_INCREMENT cho bảng `classes`
--
ALTER TABLE `classes`
  MODIFY `class_id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=10;

--
-- AUTO_INCREMENT cho bảng `class_assignments`
--
ALTER TABLE `class_assignments`
  MODIFY `assignment_id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=5;

--
-- AUTO_INCREMENT cho bảng `grades`
--
ALTER TABLE `grades`
  MODIFY `grade_id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=9;

--
-- AUTO_INCREMENT cho bảng `lecturers`
--
ALTER TABLE `lecturers`
  MODIFY `lecturer_id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=5;

--
-- AUTO_INCREMENT cho bảng `notifications`
--
ALTER TABLE `notifications`
  MODIFY `notification_id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=5;

--
-- AUTO_INCREMENT cho bảng `reports`
--
ALTER TABLE `reports`
  MODIFY `report_id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT cho bảng `roles`
--
ALTER TABLE `roles`
  MODIFY `role_id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=6;

--
-- AUTO_INCREMENT cho bảng `students`
--
ALTER TABLE `students`
  MODIFY `student_id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=6;

--
-- AUTO_INCREMENT cho bảng `tickets`
--
ALTER TABLE `tickets`
  MODIFY `ticket_id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=27;

--
-- AUTO_INCREMENT cho bảng `users`
--
ALTER TABLE `users`
  MODIFY `user_id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=18;

--
-- Các ràng buộc cho các bảng đã đổ
--

--
-- Các ràng buộc cho bảng `attendance`
--
ALTER TABLE `attendance`
  ADD CONSTRAINT `attendance_ibfk_1` FOREIGN KEY (`assignment_id`) REFERENCES `class_assignments` (`assignment_id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Các ràng buộc cho bảng `classes`
--
ALTER TABLE `classes`
  ADD CONSTRAINT `classes_ibfk_1` FOREIGN KEY (`lecturer_id`) REFERENCES `lecturers` (`lecturer_id`) ON UPDATE CASCADE,
  ADD CONSTRAINT `classes_ibfk_2` FOREIGN KEY (`created_by`) REFERENCES `users` (`user_id`) ON UPDATE CASCADE;

--
-- Các ràng buộc cho bảng `class_assignments`
--
ALTER TABLE `class_assignments`
  ADD CONSTRAINT `class_assignments_ibfk_1` FOREIGN KEY (`class_id`) REFERENCES `classes` (`class_id`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `class_assignments_ibfk_2` FOREIGN KEY (`student_id`) REFERENCES `students` (`student_id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Các ràng buộc cho bảng `grades`
--
ALTER TABLE `grades`
  ADD CONSTRAINT `grades_ibfk_1` FOREIGN KEY (`assignment_id`) REFERENCES `class_assignments` (`assignment_id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Các ràng buộc cho bảng `lecturers`
--
ALTER TABLE `lecturers`
  ADD CONSTRAINT `lecturers_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Các ràng buộc cho bảng `notifications`
--
ALTER TABLE `notifications`
  ADD CONSTRAINT `notifications_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Các ràng buộc cho bảng `reports`
--
ALTER TABLE `reports`
  ADD CONSTRAINT `reports_ibfk_1` FOREIGN KEY (`generated_by`) REFERENCES `users` (`user_id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Các ràng buộc cho bảng `tickets`
--
ALTER TABLE `tickets`
  ADD CONSTRAINT `tickets_ibfk_1` FOREIGN KEY (`submitted_by`) REFERENCES `users` (`user_id`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `tickets_ibfk_2` FOREIGN KEY (`assigned_to`) REFERENCES `users` (`user_id`) ON DELETE SET NULL ON UPDATE CASCADE;

--
-- Các ràng buộc cho bảng `users`
--
ALTER TABLE `users`
  ADD CONSTRAINT `users_ibfk_1` FOREIGN KEY (`role_id`) REFERENCES `roles` (`role_id`) ON UPDATE CASCADE;
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
